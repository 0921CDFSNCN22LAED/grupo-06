<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head')%>
    <link rel="stylesheet" href="/css/styles-productDetail.css" />
</head>

<body class="body-container">
    <header class="main-header bg-dark-gray">
        <%- include('../partials/header') %>
    </header>
    <main>
        <div class="main-container">
            <ul class="no-list progressive-links">
                <li>
                    <a class="no-link" href="/markets/"><span>markets</span></a>
                    <i class="fas fa-chevron-right"></i>
                </li>
                <li>
                    <a class="no-link" href="/markets/<%= asset.type %>"><span><%= asset.type %></span></a>
                </li>
                <li>
                    <i class="fas fa-chevron-right"></i>
                    <a class="no-link" href="/markets/<%= asset.type %>/<%= asset.name %>"><span>
                            <%= asset.name %>
                        </span></a>
                </li>
            </ul>
            <div class="main-price">
                <div>
                    <img class="currency-logo" src="<%= asset.logo %>" alt="Logo de <%= asset.ticker %>" />
                </div>
                <h1 class="heading-font currency-title">
                    <%= asset.name %> (<%= asset.ticker %>) Price
                </h1>
                <div class="price-title">
                    <span>$<%= asset.price %> </span>
                    <%if (asset.change < 0) { %>
                        <span class="percentage-change red"><%= asset.change %>%</span>
                        <% } else {%>
                            <span class="percentage-change green"><%= asset.change %>%</span>
                            <% } %>
                </div>
            </div>
            <div class="content-container">
                <div class="chart">
                    <img src="/img/chart.png" alt="<%= asset.ticker %>/USD Chart">
                </div>
                <div>
                    <h3 class="converter-title">Buy <%= asset.ticker %>
                    </h3>
                    <div class="converter">
                        <form action="/markets/cryptocurrencies/<%= asset.name %>/trade-confirmation" method="POST"></form>
                            <div class="currency first-currency">
                                <img class="currency-logo" src="<%= asset.logo %>" alt="<%= asset.ticker %> logo">
                                <p class="currency-title">
                                    <%= asset.ticker %>
                                </p>
                                <div class="currency-input-div">
                                    <input class="currency-input" type="number" value="1" maxlength="8">
                                </div>
                            </div>
                            <div class="currency second-currency">
                                <img class="currency-logo" src="/img/usd.svg" alt="USD logo">
                                <p class="currency-title">USD</p>
                                <div class="currency-input-div">
                                    <input class="currency-input" type="number" value=<%= asset.price.replace(',', '')%> maxlength="8">
                                </div>
                            </div>
                            <input type="image" id="myBtn" class="exchange-icon" src="/img/exchange.png" alt="Submit">
                            <div id="myModal" class="body-border modal">

                                <div class="modal-content">
                                    <header class="modal-header">
                                        <div class="logo">
                                            <a href="/"><img class="modal-img"src="/img/logo.svg" alt="Logo de UniFi" /></a>
                                        </div>
                                        <button><i class="fas fa-times close"></i></button>
                                    </header>
                                    <div class="subtitle">
                                        <h2>Trade confirmation</h2>
                                    </div>
                                    <div class="converter-container">
                                        <h3 class="converter-title">Do you accept this price?</h3>
                                        <form action="" method="get">
                                            <div class="modal-converter">
                                                <div class="currency first-currency">
                                                    <img class="currency-logo" src="/img/btc_logo.png" alt="BTC logo">
                                                    <p class="currency-title">Bitcoin</p>
                                                    <div class="currency-input-div">
                                                        <p class="currency-input">1</p>
                                                    </div>
                                                </div>
                                                <div class="currency second-currency">
                                                    <img class="currency-logo" src="/img/usd.svg" alt="USD logo">
                                                    <p class="currency-title">USD</p>
                                                    <div class="currency-input-div">
                                                        <p id="price" class="currency-input">60000</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="sub-price">
                                                <h4>1 BTC = 60000 USD</h4>
                                            </div>
                                            <button class="confirm-button" type="submit">Confirm</button>
                                        </form>
                                    </div>

                                    <div class="chart">
                                        <img src="/img/chart.png" alt="BTC/USD Chart" />
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="bg-dark-gray statistics-container">
                        <div class="price-statistics">
                            <h2>
                                <%= asset.ticker %> Price Statistics
                            </h2>
                            <div class="statistic">
                                <p>
                                    <%= asset.name %> Price
                                </p>
                                <p>$<%= asset.price %>
                                </p>
                            </div>
                            <div class="statistic">
                                <p>24H Price Change</p>
                                <!-- CÃ¡lculo del cambio de precio (pasa de string a float, multiplica precio * porcentaje / 100 y trunca a dos decimales)  -->
                                <p>$ <%= (parseFloat(asset.price.replace(',', '')) * asset.change / 100).toFixed(2) %> </p>
                            </div>
                            <div class="statistic">
                                <p>24h Low / High</p>
                                <p>$59,000 / $62,280</p>
                            </div>
                            <div class="statistic">
                                <p>Trading Volume</p>
                                <p>$30,000,000</p>
                            </div>
                            <div class="statistic">
                                <p>Market Cap</p>
                                <p>$<%= asset.mcap %></p>
                            </div>
                            <div class="statistic">
                                <p>Market Rank</p>
                                <p>#1</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <footer class="footer bg-dark-gray">
        <%- include('../partials/footer') %>
    </footer>
    <script>
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function () {
            modal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function () {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
    </script>
</body>

</html>